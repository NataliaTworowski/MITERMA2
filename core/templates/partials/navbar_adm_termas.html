{% load static %}

<!-- Sidebar -->
<aside id="sidebar" class="sidebar fixed md:static inset-y-0 left-0 z-50 w-64 bg-[#1F2937] text-white shadow-lg">
    <!-- Header del Sidebar -->
    <div class="flex items-center justify-between p-6 border-b border-[#374151]">
        <div class="flex items-center space-x-3">
            <img src="{% static 'img/logo.png' %}" alt="MiTerma Logo" class="w-10 h-10">
            <span class="text-xl font-bold">MiTerma Admin</span>
        </div>
        <!-- Botón cerrar en móvil -->
        <button id="closeSidebar" class="md:hidden text-white hover:text-slate-300">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
    </div>

    <!-- Información del usuario -->
    <div class="p-6 border-b border-[#374151]">
        <div class="flex items-center space-x-3">
            <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center">
                <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"></path>
                </svg>
            </div>
            <div>
                {% if usuario %}
                    <p class="font-semibold text-white">{{ usuario.nombre }} {{ usuario.apellido }}</p>
                    <p class="text-sm text-slate-300">{{ usuario.rol.nombre|title }}</p>
                    {% if usuario.terma %}
                        <p class="text-xs text-slate-400">{{ usuario.terma.nombre_terma }}</p>
                    {% endif %}
                {% else %}
                    <p class="font-semibold text-white">Usuario</p>
                    <p class="text-sm text-slate-300">Administrador</p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Navegación -->
    <nav class="flex-1 p-4">
        <ul class="space-y-2">
            <li>
                <a href="{% url 'usuarios:adm_termas' %}" class="flex items-center space-x-3 px-4 py-3 rounded-lg {% if request.resolver_match.url_name == 'adm_termas' %}bg-orange-100 text-orange-700 font-bold{% else %}hover:bg-orange-50 hover:text-orange-700 transition-colors duration-200{% endif %}">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"></path>
                    </svg>
                    <span>Inicio</span>
                </a>
            </li>
            <li>
                <a href="{% url 'termas:analisis_terma' %}" class="flex items-center space-x-3 px-4 py-3 rounded-lg {% if request.resolver_match.url_name == 'analisis_terma' %}bg-orange-100 text-orange-700 font-bold{% else %}hover:bg-orange-50 hover:text-orange-700 transition-colors duration-200{% endif %}">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
                    </svg>
                    <span>Análisis</span>
                </a>
            </li>
            <li>
                <a href="{% url 'termas:calendario_termas' %}" class="flex items-center space-x-3 px-4 py-3 rounded-lg {% if 'gestionar-terma' in request.resolver_match.url_name %}bg-orange-100 text-orange-700 font-bold{% else %}hover:bg-orange-50 hover:text-orange-700 transition-colors duration-200{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke-width="2" stroke="currentColor" fill="none"/>
                        <line x1="16" y1="2" x2="16" y2="6" stroke-width="2" stroke="currentColor"/>
                        <line x1="8" y1="2" x2="8" y2="6" stroke-width="2" stroke="currentColor"/>
                        <line x1="3" y1="10" x2="21" y2="10" stroke-width="2" stroke="currentColor"/>
                    </svg>
                    <span>Calendario</span>
                </a>
            </li>
            <li>
                <a href="{% url 'termas:editar_terma' %}" class="flex items-center space-x-3 px-4 py-3 rounded-lg {% if request.resolver_match.url_name == 'editar_terma' %}bg-orange-100 text-orange-700 font-bold{% else %}hover:bg-orange-50 hover:text-orange-700 transition-colors duration-200{% endif %}">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
                    </svg>
                    <span>Editar información de la terma</span>
                </a>
            </li>
            <li>
                <a href="{% url 'termas:precios_terma' %}" class="flex items-center space-x-3 px-4 py-3 rounded-lg {% if 'entradas' in request.resolver_match.url_name %}bg-orange-100 text-orange-700 font-bold{% else %}hover:bg-orange-50 hover:text-orange-700 transition-colors duration-200{% endif %}">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"></path>
                    </svg>
                    <span>Precios Entradas</span>
                </a>
            </li>
            <li>
                <a href="#" class="flex items-center space-x-3 px-4 py-3 rounded-lg {% if 'reportes' in request.resolver_match.url_name %}bg-orange-100 text-orange-700 font-bold{% else %}hover:bg-orange-50 hover:text-orange-700 transition-colors duration-200{% endif %}">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 10a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"></path>
                    </svg>
                    <span>Trabajadores</span>
                </a>
            </li>
            <li>
                <a href="{% url 'termas:subir_fotos' %}" class="flex items-center space-x-3 px-4 py-3 rounded-lg {% if 'fotos' in request.resolver_match.url_name %}bg-orange-100 text-orange-700 font-bold{% else %}hover:bg-orange-50 hover:text-orange-700 transition-colors duration-200{% endif %}">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2h-3L12 1H8L7 3H4zm6 4a3 3 0 100 6 3 3 0 000-6z" clip-rule="evenodd"></path>
                    </svg>
                    <span>Fotos</span>
                </a>
            </li>
            <li>
                <a href="{% url 'termas:suscripcion' %}" class="flex items-center space-x-3 px-4 py-3 rounded-lg {% if request.resolver_match.url_name == 'suscripcion' %}bg-orange-100 text-orange-700 font-bold{% else %}hover:bg-orange-50 hover:text-orange-700 transition-colors duration-200{% endif %}">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                    </svg>
                    <span>Suscripción</span>
                </a>
            </li>
            <li>
                <a href="{% url 'usuarios:billetera' %}" class="flex items-center space-x-3 px-4 py-3 rounded-lg {% if request.resolver_match.url_name == 'billetera' %}bg-orange-100 text-orange-700 font-bold{% else %}hover:bg-orange-50 hover:text-orange-700 transition-colors duration-200{% endif %}">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z"></path>
                        <path fill-rule="evenodd" d="M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z" clip-rule="evenodd"></path>
                     </svg>
                    <span>Billetera</span>
                </a>
            </li>
            
        </ul>
    </nav>

    <!-- Logout -->
    <div class="p-4 border-t border-[#374151]">
        <a href="{% url 'usuarios:logout' %}" onclick="return confirm('¿Estás seguro que deseas cerrar sesión?')" class="flex items-center space-x-3 px-4 py-3 rounded-lg text-slate-300 hover:text-white hover:bg-[#374151] transition-colors duration-200 w-full border border-[#374151] hover:border-[#6B7280]">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd"></path>
            </svg>
            <span>Cerrar Sesión</span>
        </a>
    </div>
</aside>

<!-- Overlay para móviles -->
<div id="sidebarOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden hidden"></div>

<!-- Botón para abrir sidebar en móviles -->
<button id="openSidebar" class="md:hidden fixed top-4 left-4 z-30 bg-[#1F2937] text-white p-2 rounded-lg shadow-lg">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
    </svg>
</button>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    const openBtn = document.getElementById('openSidebar');
    const closeBtn = document.getElementById('closeSidebar');

    // Abrir sidebar
    openBtn.addEventListener('click', function() {
        sidebar.classList.add('sidebar-open');
        overlay.classList.remove('hidden');
    });

    // Cerrar sidebar
    function closeSidebar() {
        sidebar.classList.remove('sidebar-open');
        overlay.classList.add('hidden');
    }

    closeBtn.addEventListener('click', closeSidebar);
    overlay.addEventListener('click', closeSidebar);

    // Cerrar con tecla Escape
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeSidebar();
        }
    });
});
</script>

<style>
.sidebar {
    transition: transform 0.3s ease-in-out;
}
.sidebar-hidden {
    transform: translateX(-100%);
}
@media (max-width: 768px) {
    .sidebar {
        transform: translateX(-100%);
    }
    .sidebar.sidebar-open {
        transform: translateX(0);
    }
}
</style>